Sell=c(382,500,463,550,200,323,456,342,578,455))
result <- EA(temp_data)
Parameter <- as.data.frame(names(result)[-6])
colnames(Parameter) <- "Parameter"
Parameter <- Parameter %>% slice(rep(row_number(), length(yrs)))
pin_res <- cbind(Parameter, res_yrs, pin_res)
View(pin_res)
yr=yrs[1]
i=8
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
pindata[is.na(pindata)] <- 0
result=EA(pindata)
result <- result[-6]
View(result)
unlist(result)
melt(result)
a=1
b=6
pindata[a:b, i] <- melt(result)$value
melt(result)$value
pindata[a:b, i] <- t(melt(result)$value)
pindata[a:b, i] <- t(unlist(result))
t(unlist(result))
pindata[a:b, i] <- unlist(result)
unlist(result)
result[["alpha"]]
pindata[a:b, i] <- unlist(result) %>% as.numeric()
unlist(result) %>% as.numeric()
pindata[a:b, i] <- unlist(result) %>% as.numeric() %>% t()
unlist(result) %>% as.numeric() %>% t()
pindata[a:b, i] <- unlist(result) %>% as.data.frame() %>% t()
unlist(result) %>% as.data.frame() %>% t()
pindata[a:b, i] <- unlist(result) %>% as.numeric() %>% as.data.frame()
unlist(result) %>% as.numeric() %>% as.data.frame()
pindata[a:b, i]
View(pindata)
pin_res[a:b, i] <- unlist(result) %>% as.numeric() %>% as.data.frame()
View(pin_res)
pin_res[a:b, 2] <- yr
a <- 1
b <- 6
for (yr in yrs) {
pin_res[a:b, 2] <- yr
for (i in numcols) {
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
pindata[is.na(pindata)] <- 0
result=EA(pindata)
result <- result[-6]
pin_res[a:b, i+2] <- unlist(result) %>% as.numeric() %>% as.data.frame()
}
a <- a + 6
b <- b + 6
}
pkgs <- c("data.table", "forecast", "tseries", "kableExtra", "reshape2", "InfoTrad", "mFilter", "tidyverse", "qrmtools", "tidyquant",
"stargazer", "qrmtools", "gridExtra", "tbl2xts", "highfrequency", "pinbasic")
# install.packages(pkgs) #install
pkgs <- c(pkgs, "timeDate", "readxl")
sapply(pkgs, library, character.only = T)
buy_file <- paste0(getwd(), "/", "Data", "/", "buys.csv")
sell_file <- paste0(getwd(), "/", "Data", "/", "sells.csv")
buy_data <- read.csv(buy_file)
sell_data <- read.csv(sell_file)
test <- colnames(buy_data) %in% colnames(sell_data)
cn <- which(test==FALSE)
buy_data <- buy_data[, -cn, drop = FALSE]
buy_data$Date <- ymd(buy_data$Date)
buy_data <- tbl_xts(buy_data)
sell_data$Date <- ymd(sell_data$Date)
sell_data <- tbl_xts(sell_data)
numcols <- ncol(sell_data)
first_year <- substr(index(buy_data[1,]), 1, 4)
last_year <- substr(index(buy_data[nrow(buy_data),]), 1, 4)
yrs <- as.numeric(first_year):as.numeric(last_year) %>%
as.character()
pin_res <- matrix(NA, nrow = 6*length(yrs), ncol = ncol(buy_data))
pin_res <- data.frame(pin_res)
colnames(pin_res) <- colnames(buy_data)
res_yrs <- matrix(NA, nrow = 6*length(yrs), ncol = 1)
colnames(res_yrs) <- "Year"
temp_data <- data.frame(Buy=c(350,250,500,552,163,345,847,923,123,349),
Sell=c(382,500,463,550,200,323,456,342,578,455))
result <- EA(temp_data)
Parameter <- as.data.frame(names(result)[-6])
colnames(Parameter) <- "Parameter"
Parameter <- Parameter %>% slice(rep(row_number(), length(yrs)))
pin_res <- cbind(Parameter, res_yrs, pin_res)
a <- 1
b <- 6
debugSource('C:/Users/813908/Downloads/PIN Estimation/PIN.R', echo=TRUE)
View(pin_res)
View(result)
debugSource('C:/Users/813908/Downloads/PIN Estimation/PIN.R', echo=TRUE)
View(result)
all(is.na(pindata))
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
all(is.na(pindata))
View(pindata)
debugSource('C:/Users/813908/Downloads/PIN Estimation/PIN.R', echo=TRUE)
debugSource('C:/Users/813908/Downloads/PIN Estimation/PIN.R', echo=TRUE)
all(is.na(pindata))
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
all(is.na(pindata))
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
source('C:/Users/813908/Downloads/PIN Estimation/PIN.R', echo=TRUE)
View(pin_res)
View(pindata)
result=EA(pindata)
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
sum(is.na(pindata)==T)
251*2
410/502
(1-(401/502))*502
101/2
sum(is.na(pindata)==F)
92/2
60*2
source('C:/Users/813908/Downloads/PIN Estimation/PIN.R', echo=TRUE)
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
View(pindata)
sum(is.na(pindata)
-
)
sum(is.na(pindata)==F)
source('C:/Users/813908/Downloads/PIN Estimation/PIN.R', echo=TRUE)
View(pin_res)
bs=pindata[,1,drop=F]
ss=pindata[,2,drop=F]
abs(bs[, "Buy"] - ss[, "Sell"])
bs <- pindata[, 18, drop = F]
bs <- pindata
View(bs)
colnames(bs) <- c("Buy", "Sell")
abs(bs[, "Buy"] - bs[, "Sell"])
bs = as.bs.frame(pindata)
bs = as.data.frame(pindata)
choice <- match.arg(likelihood)
colnames(bs) <- c("Buy", "Sell")
sign_imbalance = bs[, "Buy"] - bs[, "Sell"]
abs_imbalance = abs(bs[, "Buy"] - bs[, "Sell"])
bs["abs_Imbalance"] = abs_imbalance
clusters = hclust(dist(bs[, "abs_Imbalance"]))
result=EA(pindata)
bs = as.data.frame(pindata)
colnames(bs) <- c("Buy", "Sell")
sign_imbalance = bs[, "Buy"] - bs[, "Sell"]
bs["sign_Imbalance"] = sign_imbalance
abs_imbalance = abs(bs[, "Buy"] - bs[, "Sell"])
bs["abs_Imbalance"] = abs_imbalance
clusters = hclust(dist(bs[, "abs_Imbalance"]))
clusterCut = cutree(clusters, 2)
bs["Cluster"] = clusterCut
t = table(clusterCut, bs$Cluster)
f_mean = mean(bs[which(bs[, 5] == 1), ][, 4])
s_mean = mean(bs[which(bs[, 5] == 2), ][, 4])
means = c(f_mean, s_mean)
event = which(means == max(means))
no_event = which(means == min(means))
event_bs = bs[bs$Cluster == event, ]
View(event_bs)
clusters_E = hclust(dist(event_bs[, "sign_Imbalance"]))
tmp <- dist(event_bs[, "sign_Imbalance"])
?dist
i=17
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
bs = as.data.frame(pindata)
choice <- match.arg(likelihood)
colnames(bs) <- c("Buy", "Sell")
sign_imbalance = bs[, "Buy"] - bs[, "Sell"]
bs["sign_Imbalance"] = sign_imbalance
abs_imbalance = abs(bs[, "Buy"] - bs[, "Sell"])
bs["abs_Imbalance"] = abs_imbalance
clusters = hclust(dist(bs[, "abs_Imbalance"]))
clusterCut = cutree(clusters, 2)
bs["Cluster"] = clusterCut
t = table(clusterCut, bs$Cluster)
f_mean = mean(bs[which(bs[, 5] == 1), ][, 4])
s_mean = mean(bs[which(bs[, 5] == 2), ][, 4])
means = c(f_mean, s_mean)
event = which(means == max(means))
no_event = which(means == min(means))
event_bs = bs[bs$Cluster == event, ]
clusters_E = hclust(dist(event_bs[, "sign_Imbalance"]))
View(pindata)
i=17
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
sum(is.na(pindata)==F)
i=8
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
sum(is.na(pindata)==F)
pindata[is.na(pindata)] <- 0
bs = as.data.frame(pindata)
choice <- match.arg(likelihood)
colnames(bs) <- c("Buy", "Sell")
sign_imbalance = bs[, "Buy"] - bs[, "Sell"]
bs["sign_Imbalance"] = sign_imbalance
abs_imbalance = abs(bs[, "Buy"] - bs[, "Sell"])
bs["abs_Imbalance"] = abs_imbalance
clusters = hclust(dist(bs[, "abs_Imbalance"]))
clusterCut = cutree(clusters, 2)
bs["Cluster"] = clusterCut
t = table(clusterCut, bs$Cluster)
f_mean = mean(bs[which(bs[, 5] == 1), ][, 4])
s_mean = mean(bs[which(bs[, 5] == 2), ][, 4])
means = c(f_mean, s_mean)
event = which(means == max(means))
no_event = which(means == min(means))
event_bs = bs[bs$Cluster == event, ]
tester <- dist(event_bs[, "sign_Imbalance"])
tmp=hclust(dist(event_bs[, "sign_Imbalance"]))
View(tmp)
event = which(means == max(means))
no_event = which(means == min(means))
event_bs = bs[bs$Cluster == event, ]
View(bs)
View(clusters)
source('C:/Users/813908/Downloads/PIN Estimation/PIN.R', echo=TRUE)
View(pin_res)
source('C:/Users/813908/Downloads/PIN Estimation/PIN.R', echo=TRUE)
bs = as.data.frame(pindata)
colnames(bs) <- c("Buy", "Sell")
sign_imbalance = bs[, "Buy"] - bs[, "Sell"]
bs["sign_Imbalance"] = sign_imbalance
abs_imbalance = abs(bs[, "Buy"] - bs[, "Sell"])
bs["abs_Imbalance"] = abs_imbalance
clusters = hclust(dist(bs[, "abs_Imbalance"]))
clusterCut = cutree(clusters, 2)
bs["Cluster"] = clusterCut
t = table(clusterCut, bs$Cluster)
f_mean = mean(bs[which(bs[, 5] == 1), ][, 4])
s_mean = mean(bs[which(bs[, 5] == 2), ][, 4])
means = c(f_mean, s_mean)
event = which(means == max(means))
no_event = which(means == min(means))
event_bs = bs[bs$Cluster == event, ]
View(event_bs)
View(bs)
?cutree
View(clusters)
?hclust
i=8
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
pindata[is.na(pindata)] <- 0
bs = as.data.frame(pindata)
colnames(bs) <- c("Buy", "Sell")
sign_imbalance = bs[, "Buy"] - bs[, "Sell"]
bs["sign_Imbalance"] = sign_imbalance
abs_imbalance = abs(bs[, "Buy"] - bs[, "Sell"])
bs["abs_Imbalance"] = abs_imbalance
clusters = hclust(dist(bs[, "abs_Imbalance"]))
clusterCut = cutree(clusters, 2)
bs["Cluster"] = clusterCut
t = table(clusterCut, bs$Cluster)
f_mean = mean(bs[which(bs[, 5] == 1), ][, 4])
s_mean = mean(bs[which(bs[, 5] == 2), ][, 4])
means = c(f_mean, s_mean)
event = which(means == max(means))
no_event = which(means == min(means))
event_bs = bs[bs$Cluster == event, ]
clusters_E = hclust(dist(event_bs[, "sign_Imbalance"]))
clusterCut_E = cutree(clusters_E, 2, h = 0)
pin_test <- pin_est(numbuys = bs[,"Buys"],
numsells = bs[,"Sells"],
confint = TRUE, ci_control = list(n = 1000, seed = 123),
posterior = TRUE)
View(bs)
pin_test <- pin_est(numbuys = bs[,"Buy"],
numsells = bs[,"Sell"],
confint = TRUE, ci_control = list(n = 1000, seed = 123),
posterior = TRUE)
View(pin_test)
i
i=18
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
pindata[is.na(pindata)] <- 0
bs=pindata
colnames(bs) <- c("Buy", "Sell")
pin_test <- pin_est(numbuys = bs[,"Buy"],
numsells = bs[,"Sell"],
confint = TRUE, ci_control = list(n = 1000, seed = 123),
posterior = TRUE)
View(pin_test)
pin_test[["Results"]]
i=7
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
pindata[is.na(pindata)] <- 0
bs = as.data.frame(pindata)
colnames(bs) <- c("Buy", "Sell")
pin_test <- pin_est(numbuys = bs[,"Buy"],
numsells = bs[,"Sell"],
confint = TRUE, ci_control = list(n = 1000, seed = 123),
posterior = TRUE)
warnings()
View(pin_test)
pin_test[["Results"]].
pin_test[["Results"]]
pin_test[["pin"]]
i=8
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
pindata[is.na(pindata)] <- 0
bs = as.data.frame(pindata)
colnames(bs) <- c("Buy", "Sell")
sign_imbalance = bs[, "Buy"] - bs[, "Sell"]
pin_test <- pin_est(numbuys = bs[,"Buy"],
numsells = bs[,"Sell"],
confint = TRUE, ci_control = list(n = 1000, seed = 123),
posterior = TRUE)
View(pin_test)
pin_test[["Results"]]
pin_test$Results
pin_test$Results
wtf
pin_test$Results
pindata <- pindata["2008/06"]
result=EA(pindata)
View(pindata)
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
View(pindata)
pindata["2008/06"]
pindata["2008-06"]
pindata=pindata["2008-06"]
result=EA(pindata)
pindata[is.na(pindata)] <- 0
result=EA(pindata)
View(result)
?tryCatch
result <- pin_est(numbuys = pindata[,"Buy"],
numsells = pindata[,"Sell"],
confint = TRUE, ci_control = list(n = 1000, seed = 123),
posterior = TRUE)
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
colnames(pindata) <- c("Buy", "Sell")
pindata[is.na(pindata)] <- 0
result <- pin_est(numbuys = pindata[,"Buy"],
numsells = pindata[,"Sell"],
confint = TRUE, ci_control = list(n = 1000, seed = 123),
posterior = TRUE)
View(result)
i
i=5
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
colnames(pindata) <- c("Buy", "Sell")
pindata[is.na(pindata)] <- 0
result <- pin_est(numbuys = pindata[,"Buy"],
numsells = pindata[,"Sell"],
confint = TRUE, ci_control = list(n = 1000, seed = 123),
posterior = TRUE)
i=6
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
colnames(pindata) <- c("Buy", "Sell")
pindata[is.na(pindata)] <- 0
result <- pin_est(numbuys = pindata[,"Buy"],
numsells = pindata[,"Sell"],
confint = TRUE, ci_control = list(n = 1000, seed = 123),
posterior = TRUE)
View(result)
pkgs <- c("data.table", "forecast", "tseries", "kableExtra", "reshape2", "InfoTrad", "mFilter", "tidyverse", "qrmtools", "tidyquant",
"stargazer", "qrmtools", "gridExtra", "tbl2xts", "highfrequency", "pinbasic")
# install.packages(pkgs) #install
pkgs <- c(pkgs, "timeDate", "readxl")
sapply(pkgs, library, character.only = T)
buy_file <- paste0(getwd(), "/", "Data", "/", "buys.csv")
sell_file <- paste0(getwd(), "/", "Data", "/", "sells.csv")
buy_data <- read.csv(buy_file)
sell_data <- read.csv(sell_file)
test <- colnames(buy_data) %in% colnames(sell_data)
cn <- which(test==FALSE)
buy_data <- buy_data[, -cn, drop = FALSE]
buy_data$Date <- ymd(buy_data$Date)
buy_data <- tbl_xts(buy_data)
sell_data$Date <- ymd(sell_data$Date)
sell_data <- tbl_xts(sell_data)
numcols <- 1:ncol(sell_data)
first_year <- substr(index(buy_data[1,]), 1, 4)
last_year <- substr(index(buy_data[nrow(buy_data),]), 1, 4)
yrs <- as.numeric(first_year):as.numeric(last_year) %>%
as.character()
pin_res <- matrix(NA, nrow = 6*length(yrs), ncol = ncol(buy_data))
pin_res <- data.frame(pin_res)
colnames(pin_res) <- colnames(buy_data)
res_yrs <- matrix(NA, nrow = 6*length(yrs), ncol = 1)
colnames(res_yrs) <- "Year"
temp_data <- data.frame(Buy=c(350,250,500,552,163,345,847,923,123,349),
Sell=c(382,500,463,550,200,323,456,342,578,455))
result <- EA(temp_data)
Parameter <- as.data.frame(names(result)[-6])
colnames(Parameter) <- "Parameter"
Parameter <- Parameter %>% slice(rep(row_number(), length(yrs)))
pin_res <- cbind(Parameter, res_yrs, pin_res)
a <- 1
b <- 6
View(result)
df <- result[1]
df <- result[[1]]
result <- pin_est(numbuys = pindata[,"Buy"],
numsells = pindata[,"Sell"],
confint = TRUE, ci_control = list(n = 1000, seed = 123),
posterior = TRUE)
i=8
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
yr = yrs[1]
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
colnames(pindata) <- c("Buy", "Sell")
pindata[is.na(pindata)] <- 0
result <- pin_est(numbuys = pindata[,"Buy"],
numsells = pindata[,"Sell"],
confint = TRUE, ci_control = list(n = 1000, seed = 123),
posterior = TRUE)
View(result)
df <- result[[1]]
View(df)
df <- result[[1]][,1]
df <- result[[1]][,1, drop = F]
View(df)
df <- rbind(df, result[[3]])
View(df)
rownames(df)[6] <- "PIN"
source('C:/Users/813908/Downloads/PIN Estimation/PIN Estimation.R', echo=TRUE)
View(pin_res)
write.csv(pin_res, "PIN Estimation Results - Annual.csv", row.names = FALSE)
View(pin_res)
saveRDS(pin_res, file = "PIN Estimation Results - Annual.rds")
pkgs <- c("data.table", "forecast", "tseries", "kableExtra", "reshape2", "InfoTrad", "mFilter", "tidyverse", "qrmtools", "tidyquant",
"stargazer", "qrmtools", "gridExtra", "tbl2xts", "highfrequency", "pinbasic")
# install.packages(pkgs) #install
pkgs <- c(pkgs, "timeDate", "readxl")
sapply(pkgs, library, character.only = T)
buy_file <- paste0(getwd(), "/", "Data", "/", "buys.csv")
sell_file <- paste0(getwd(), "/", "Data", "/", "sells.csv")
buy_data <- read.csv(buy_file)
sell_data <- read.csv(sell_file)
test <- colnames(buy_data) %in% colnames(sell_data)
cn <- which(test==FALSE)
buy_data <- buy_data[, -cn, drop = FALSE]
buy_data$Date <- ymd(buy_data$Date)
buy_data <- tbl_xts(buy_data)
sell_data$Date <- ymd(sell_data$Date)
sell_data <- tbl_xts(sell_data)
numcols <- 1:ncol(sell_data)
first_year <- substr(index(buy_data[1,]), 1, 4)
last_year <- substr(index(buy_data[nrow(buy_data),]), 1, 4)
yrs <- as.numeric(first_year):as.numeric(last_year) %>%
as.character()
pin_res <- matrix(NA, nrow = 6*length(yrs), ncol = ncol(buy_data))
pin_res <- data.frame(pin_res)
colnames(pin_res) <- colnames(buy_data)
res_yrs <- matrix(NA, nrow = 6*length(yrs)*12, ncol = 1)
colnames(res_yrs) <- "Year"
temp_data <- data.frame(Buy=c(350,250,500,552,163,345,847,923,123,349),
Sell=c(382,500,463,550,200,323,456,342,578,455))
result <- EA(temp_data)
Parameter <- as.data.frame(names(result)[-6])
colnames(Parameter) <- "Parameter"
Parameter <- Parameter %>% slice(rep(row_number(), length(yrs)))
pin_res <- cbind(Parameter, res_yrs, pin_res)
a <- 1
b <- 6
View(pin_res)
i=8
yr=yrs[1]
pindata <- cbind(buy_data[yr, i], sell_data[yr, i])
colnames(pindata) <- c("Buy", "Sell")
pindata[is.na(pindata)] <- 0
result <- pin_est(numbuys = pindata[,"Buy"],
numsells = pindata[,"Sell"],
confint = TRUE, ci_control = list(n = 1000, seed = 123),
posterior = TRUE)
df <- result[[1]][,1, drop = F]
View(df)
ann_res <- load("PIN Estimation Results - Annual.rds")
`PIN Estimation Results - Annual` <- readRDS("C:/Users/813908/Downloads/PIN Estimation/PIN Estimation Results - Annual.rds")
View(`PIN Estimation Results - Annual`)
ann_res <- <- readRDS("C:/Users/813908/Downloads/PIN Estimation/PIN Estimation Results - Annual.rds")
ann_res <- readRDS("C:/Users/813908/Downloads/PIN Estimation/PIN Estimation Results - Annual.rds")
labs
Parameter <- as.data.frame(df)
colnames(Parameter) <- "Parameter"
Parameter <- as.data.frame(names(df))
View(Parameter)
Parameter <- as.data.frame(rownames(df))
View(Parameter)
Parameter <- rbind(Parameter, "PIN")
colnames(Parameter) <- "Parameter"
Parameter <- rbind(Parameter, as.data.frame("PIN"))
pin_df <- as.data.frame("PIN")
colnames(pin_df) <- colnames(Parameter)
Parameter <- rbind(Parameter, pin_df)
View(Parameter)
Parameter <- as.data.frame(rownames(df))
colnames(Parameter) <- "Parameter"
pin_df <- as.data.frame("PIN")
colnames(pin_df) <- colnames(Parameter)
Parameter <- rbind(Parameter, pin_df)
Parameter <- Parameter %>% slice(rep(row_number(), length(yrs)))
View(Parameter)
ann_res <- ann_res[, -1, drop = FALSE]
View(ann_res)
ann_res <- cbind(Parameter, ann_res)
View(ann_res)
pin_res <- readRDS("C:/Users/813908/Downloads/PIN Estimation/PIN Estimation Results - Annual.rds")
View(pin_res)
pin_res <- pin_res[, -1, drop = F]
Parameter <- as.data.frame(rownames(df))
colnames(Parameter) <- "Parameter"
pin_df <- as.data.frame("PIN")
colnames(pin_df) <- colnames(Parameter)
Parameter <- rbind(Parameter, pin_df)
Parameter <- Parameter %>% slice(rep(row_number(), length(yrs)))
pin_res <- cbind(Parameter, pin_res)
write.csv(pin_res, "PIN Estimation Results - Annual.csv", row.names = FALSE)
write.csv(pin_res, "PIN Estimation Results - Annual.csv", row.names = FALSE)
saveRDS(pin_res, file = "PIN Estimation Results - Annual.rds")
